import{_ as V}from"./vendor-@babel.js";import{r as f}from"./vendor-react.js";import{L as _e,T as kt,R as Ft,U as zt,a as Bt,O as He,P as We,S as Ye,b as Pe,N as It,A as Ht,B as Wt,M as $t,C as lt,V as X,c as Gt,W as Nt,d as Vt,e as qt,f as Ut,g as Xt,h as Zt,i as Yt,D as ke,j as ge,k as Fe,l as Ke,H as Kt,m as Jt,F as Qt,n as Je,o as en,p as tn,q as nn,r as rn,s as on,t as sn,u as Qe}from"./vendor-three.js";import{u as an}from"./vendor-react-use-measure.js";import{F as cn,u as ln}from"./vendor-its-fine.js";import{R as un,c as ie}from"./vendor-react-reconciler.js";import{s as et}from"./vendor-scheduler.js";import{c as fn}from"./vendor-react-dom.js";import{c as ut}from"./vendor-zustand.js";import{S as Se,G as $e,D as dn,M as xe,O as pn,F as Ge,H as mn,V as vn}from"./vendor-three-stdlib.js";import{m as hn}from"./vendor-react-merge-refs.js";import{s as gn,p as yn,c as bn}from"./vendor-suspend-react.js";const Ne={},wn=e=>void Object.assign(Ne,e);function En(e,t){function r(n,{args:o=[],attach:l,...p},v){let M=`${n[0].toUpperCase()}${n.slice(1)}`,m;if(n==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const c=p.object;m=re(c,{type:n,root:v,attach:l,primitive:!0})}else{const c=Ne[M];if(!c)throw new Error(`R3F: ${M} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");m=re(new c(...o),{type:n,root:v,attach:l,memoizedProps:{args:o}})}return m.__r3f.attach===void 0&&(m instanceof Wt?m.__r3f.attach="geometry":m instanceof $t&&(m.__r3f.attach="material")),M!=="inject"&&Oe(m,p),m}function i(n,o){let l=!1;if(o){var p,v;(p=o.__r3f)!=null&&p.attach?Re(n,o,o.__r3f.attach):o.isObject3D&&n.isObject3D&&(n.add(o),l=!0),l||(v=n.__r3f)==null||v.objects.push(o),o.__r3f||re(o,{}),o.__r3f.parent=n,Be(o),oe(o)}}function s(n,o,l){let p=!1;if(o){var v,M;if((v=o.__r3f)!=null&&v.attach)Re(n,o,o.__r3f.attach);else if(o.isObject3D&&n.isObject3D){o.parent=n,o.dispatchEvent({type:"added"});const m=n.children.filter(d=>d!==o),c=m.indexOf(l);n.children=[...m.slice(0,c),o,...m.slice(c)],p=!0}p||(M=n.__r3f)==null||M.objects.push(o),o.__r3f||re(o,{}),o.__r3f.parent=n,Be(o),oe(o)}}function u(n,o,l=!1){n&&[...n].forEach(p=>g(o,p,l))}function g(n,o,l){if(o){var p,v,M;if(o.__r3f&&(o.__r3f.parent=null),(p=n.__r3f)!=null&&p.objects&&(n.__r3f.objects=n.__r3f.objects.filter(P=>P!==o)),(v=o.__r3f)!=null&&v.attach)it(n,o,o.__r3f.attach);else if(o.isObject3D&&n.isObject3D){var m;n.remove(o),(m=o.__r3f)!=null&&m.root&&Tn(o.__r3f.root,o)}const d=(M=o.__r3f)==null?void 0:M.primitive,y=!d&&(l===void 0?o.dispose!==null:l);if(!d){var c;u((c=o.__r3f)==null?void 0:c.objects,o,y),u(o.children,o,y)}if(delete o.__r3f,y&&o.dispose&&o.type!=="Scene"){const P=()=>{try{o.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?et.unstable_scheduleCallback(et.unstable_IdlePriority,P):P()}oe(n)}}function h(n,o,l,p){var v;const M=(v=n.__r3f)==null?void 0:v.parent;if(!M)return;const m=r(o,l,n.__r3f.root);if(n.children){for(const c of n.children)c.__r3f&&i(m,c);n.children=n.children.filter(c=>!c.__r3f)}n.__r3f.objects.forEach(c=>i(m,c)),n.__r3f.objects=[],n.__r3f.autoRemovedBeforeAppend||g(M,n),m.parent&&(m.__r3f.autoRemovedBeforeAppend=!0),i(M,m),m.raycast&&m.__r3f.eventCount&&m.__r3f.root.getState().internal.interaction.push(m),[p,p.alternate].forEach(c=>{c!==null&&(c.stateNode=m,c.ref&&(typeof c.ref=="function"?c.ref(m):c.ref.current=m))})}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:un({createInstance:r,removeChild:g,appendChild:i,appendInitialChild:i,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(n,o)=>{if(!o)return;const l=n.getState().scene;l.__r3f&&(l.__r3f.root=n,i(l,o))},removeChildFromContainer:(n,o)=>{o&&g(n.getState().scene,o)},insertInContainerBefore:(n,o,l)=>{if(!o||!l)return;const p=n.getState().scene;p.__r3f&&s(p,o,l)},getRootHostContext:()=>null,getChildHostContext:n=>n,finalizeInitialChildren(n){var o;return!!((o=n==null?void 0:n.__r3f)!=null?o:{}).handlers},prepareUpdate(n,o,l,p){var v;if(((v=n==null?void 0:n.__r3f)!=null?v:{}).primitive&&p.object&&p.object!==n)return[!0];{const{args:m=[],children:c,...d}=p,{args:y=[],children:P,..._}=l;if(!Array.isArray(m))throw new Error("R3F: the args prop must be an array!");if(m.some((x,C)=>x!==y[C]))return[!0];const w=gt(n,d,_,!0);return w.changes.length?[!1,w]:null}},commitUpdate(n,[o,l],p,v,M,m){o?h(n,p,M,m):Oe(n,l)},commitMount(n,o,l,p){var v;const M=(v=n.__r3f)!=null?v:{};n.raycast&&M.handlers&&M.eventCount&&n.__r3f.root.getState().internal.interaction.push(n)},getPublicInstance:n=>n,prepareForCommit:()=>null,preparePortalMount:n=>re(n.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(n){var o;const{attach:l,parent:p}=(o=n.__r3f)!=null?o:{};l&&p&&it(p,n,l),n.isObject3D&&(n.visible=!1),oe(n)},unhideInstance(n,o){var l;const{attach:p,parent:v}=(l=n.__r3f)!=null?l:{};p&&v&&Re(v,n,p),(n.isObject3D&&o.visible==null||o.visible)&&(n.visible=!0),oe(n)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():ie.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&A.fun(performance.now)?performance.now:A.fun(Date.now)?Date.now:()=>0,scheduleTimeout:A.fun(setTimeout)?setTimeout:void 0,cancelTimeout:A.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Oe}}var tt,nt;const Ce=e=>"colorSpace"in e||"outputColorSpace"in e,ft=()=>{var e;return(e=Ne.ColorManagement)!=null?e:null},dt=e=>e&&e.isOrthographicCamera,Mn=e=>e&&e.hasOwnProperty("current"),fe=typeof window<"u"&&((tt=window.document)!=null&&tt.createElement||((nt=window.navigator)==null?void 0:nt.product)==="ReactNative")?f.useLayoutEffect:f.useEffect;function pt(e){const t=f.useRef(e);return fe(()=>void(t.current=e),[e]),t}function _n({set:e}){return fe(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class mt extends f.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}mt.getDerivedStateFromError=()=>({error:!0});const vt="__default",rt=new Map,Pn=e=>e&&!!e.memoized&&!!e.changes;function ht(e){var t;const r=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}const ce=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()},A={obj:e=>e===Object(e)&&!A.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:i="reference",strict:s=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(A.str(e)||A.num(e))return e===t;const u=A.obj(e);if(u&&i==="reference")return e===t;const g=A.arr(e);if(g&&r==="reference")return e===t;if((g||u)&&e===t)return!0;let h;for(h in e)if(!(h in t))return!1;if(u&&r==="shallow"&&i==="shallow"){for(h in s?t:e)if(!A.equ(e[h],t[h],{strict:s,objects:"reference"}))return!1}else for(h in s?t:e)if(e[h]!==t[h])return!1;if(A.und(h)){if(g&&e.length===0&&t.length===0||u&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Sn(e){const t={nodes:{},materials:{}};return e&&e.traverse(r=>{r.name&&(t.nodes[r.name]=r),r.material&&!t.materials[r.material.name]&&(t.materials[r.material.name]=r.material)}),t}function xn(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function re(e,t){const r=e;return r.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function ze(e,t){let r=e;if(t.includes("-")){const i=t.split("-"),s=i.pop();return r=i.reduce((u,g)=>u[g],e),{target:r,key:s}}else return{target:r,key:t}}const ot=/-\d+$/;function Re(e,t,r){if(A.str(r)){if(ot.test(r)){const u=r.replace(ot,""),{target:g,key:h}=ze(e,u);Array.isArray(g[h])||(g[h]=[])}const{target:i,key:s}=ze(e,r);t.__r3f.previousAttach=i[s],i[s]=t}else t.__r3f.previousAttach=r(e,t)}function it(e,t,r){var i,s;if(A.str(r)){const{target:u,key:g}=ze(e,r),h=t.__r3f.previousAttach;h===void 0?delete u[g]:u[g]=h}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(s=t.__r3f)==null||delete s.previousAttach}function gt(e,{children:t,key:r,ref:i,...s},{children:u,key:g,ref:h,...a}={},b=!1){var n;const o=(n=e==null?void 0:e.__r3f)!=null?n:{},l=Object.entries(s),p=[];if(b){const M=Object.keys(a);for(let m=0;m<M.length;m++)s.hasOwnProperty(M[m])||l.unshift([M[m],vt+"remove"])}l.forEach(([M,m])=>{var c;if((c=e.__r3f)!=null&&c.primitive&&M==="object"||A.equ(m,a[M]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(M))return p.push([M,m,!0,[]]);let d=[];M.includes("-")&&(d=M.split("-")),p.push([M,m,!1,d]);for(const y in s){const P=s[y];y.startsWith(`${M}-`)&&p.push([y,P,!1,y.split("-")])}});const v={...s};return o.memoizedProps&&o.memoizedProps.args&&(v.args=o.memoizedProps.args),o.memoizedProps&&o.memoizedProps.attach&&(v.attach=o.memoizedProps.attach),{memoized:v,changes:p}}const Cn=typeof process<"u"&&!0;function Oe(e,t){var r,i,s;const u=(r=e.__r3f)!=null?r:{},g=u.root,h=(i=g==null||g.getState==null?void 0:g.getState())!=null?i:{},{memoized:a,changes:b}=Pn(t)?t:gt(e,t),n=u.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let l=0;l<b.length;l++){let[p,v,M,m]=b[l];if(Ce(e)){const P="srgb",_="srgb-linear";p==="encoding"?(p="colorSpace",v=v===3001?P:_):p==="outputEncoding"&&(p="outputColorSpace",v=v===3001?P:_)}let c=e,d=c[p];if(m.length&&(d=m.reduce((y,P)=>y[P],e),!(d&&d.set))){const[y,...P]=m.reverse();c=P.reverse().reduce((_,w)=>_[w],e),p=y}if(v===vt+"remove")if(c.constructor){let y=rt.get(c.constructor);y||(y=new c.constructor,rt.set(c.constructor,y)),v=y[p]}else v=0;if(M)v?u.handlers[p]=v:delete u.handlers[p],u.eventCount=Object.keys(u.handlers).length;else if(d&&d.set&&(d.copy||d instanceof _e)){if(Array.isArray(v))d.fromArray?d.fromArray(v):d.set(...v);else if(d.copy&&v&&v.constructor&&(Cn?d.constructor.name===v.constructor.name:d.constructor===v.constructor))d.copy(v);else if(v!==void 0){const y=d instanceof lt;!y&&d.setScalar?d.setScalar(v):d instanceof _e&&v instanceof _e?d.mask=v.mask:d.set(v),!ft()&&!h.linear&&y&&d.convertSRGBToLinear()}}else if(c[p]=v,c[p]instanceof kt&&c[p].format===Ft&&c[p].type===zt){const y=c[p];Ce(y)&&Ce(h.gl)?y.colorSpace=h.gl.outputColorSpace:y.encoding=h.gl.outputEncoding}oe(e)}if(u.parent&&h.internal&&e.raycast&&n!==u.eventCount){const l=h.internal.interaction.indexOf(e);l>-1&&h.internal.interaction.splice(l,1),u.eventCount&&h.internal.interaction.push(e)}return!(b.length===1&&b[0][0]==="onUpdate")&&b.length&&(s=e.__r3f)!=null&&s.parent&&Be(e),e}function oe(e){var t,r;const i=(t=e.__r3f)==null||(r=t.root)==null||r.getState==null?void 0:r.getState();i&&i.internal.frames===0&&i.invalidate()}function Be(e){e.onUpdate==null||e.onUpdate(e)}function Rn(e,t){e.manual||(dt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ye(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function On(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return ie.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ie.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ie.ContinuousEventPriority;default:return ie.DefaultEventPriority}}function yt(e,t,r,i){const s=r.get(t);s&&(r.delete(t),r.size===0&&(e.delete(i),s.target.releasePointerCapture(i)))}function Tn(e,t){const{internal:r}=e.getState();r.interaction=r.interaction.filter(i=>i!==t),r.initialHits=r.initialHits.filter(i=>i!==t),r.hovered.forEach((i,s)=>{(i.eventObject===t||i.object===t)&&r.hovered.delete(s)}),r.capturedMap.forEach((i,s)=>{yt(r.capturedMap,t,i,s)})}function jn(e){function t(a){const{internal:b}=e.getState(),n=a.offsetX-b.initialClick[0],o=a.offsetY-b.initialClick[1];return Math.round(Math.sqrt(n*n+o*o))}function r(a){return a.filter(b=>["Move","Over","Enter","Out","Leave"].some(n=>{var o;return(o=b.__r3f)==null?void 0:o.handlers["onPointer"+n]}))}function i(a,b){const n=e.getState(),o=new Set,l=[],p=b?b(n.internal.interaction):n.internal.interaction;for(let c=0;c<p.length;c++){const d=ce(p[c]);d&&(d.raycaster.camera=void 0)}n.previousRoot||n.events.compute==null||n.events.compute(a,n);function v(c){const d=ce(c);if(!d||!d.events.enabled||d.raycaster.camera===null)return[];if(d.raycaster.camera===void 0){var y;d.events.compute==null||d.events.compute(a,d,(y=d.previousRoot)==null?void 0:y.getState()),d.raycaster.camera===void 0&&(d.raycaster.camera=null)}return d.raycaster.camera?d.raycaster.intersectObject(c,!0):[]}let M=p.flatMap(v).sort((c,d)=>{const y=ce(c.object),P=ce(d.object);return!y||!P?c.distance-d.distance:P.events.priority-y.events.priority||c.distance-d.distance}).filter(c=>{const d=ye(c);return o.has(d)?!1:(o.add(d),!0)});n.events.filter&&(M=n.events.filter(M,n));for(const c of M){let d=c.object;for(;d;){var m;(m=d.__r3f)!=null&&m.eventCount&&l.push({...c,eventObject:d}),d=d.parent}}if("pointerId"in a&&n.internal.capturedMap.has(a.pointerId))for(let c of n.internal.capturedMap.get(a.pointerId).values())o.has(ye(c.intersection))||l.push(c.intersection);return l}function s(a,b,n,o){const l=e.getState();if(a.length){const p={stopped:!1};for(const v of a){const M=ce(v.object)||l,{raycaster:m,pointer:c,camera:d,internal:y}=M,P=new X(c.x,c.y,0).unproject(d),_=R=>{var E,O;return(E=(O=y.capturedMap.get(R))==null?void 0:O.has(v.eventObject))!=null?E:!1},w=R=>{const E={intersection:v,target:b.target};y.capturedMap.has(R)?y.capturedMap.get(R).set(v.eventObject,E):y.capturedMap.set(R,new Map([[v.eventObject,E]])),b.target.setPointerCapture(R)},x=R=>{const E=y.capturedMap.get(R);E&&yt(y.capturedMap,v.eventObject,E,R)};let C={};for(let R in b){let E=b[R];typeof E!="function"&&(C[R]=E)}let S={...v,...C,pointer:c,intersections:a,stopped:p.stopped,delta:n,unprojectedPoint:P,ray:m.ray,camera:d,stopPropagation(){const R="pointerId"in b&&y.capturedMap.get(b.pointerId);if((!R||R.has(v.eventObject))&&(S.stopped=p.stopped=!0,y.hovered.size&&Array.from(y.hovered.values()).find(E=>E.eventObject===v.eventObject))){const E=a.slice(0,a.indexOf(v));u([...E,v])}},target:{hasPointerCapture:_,setPointerCapture:w,releasePointerCapture:x},currentTarget:{hasPointerCapture:_,setPointerCapture:w,releasePointerCapture:x},nativeEvent:b};if(o(S),p.stopped===!0)break}}return a}function u(a){const{internal:b}=e.getState();for(const n of b.hovered.values())if(!a.length||!a.find(o=>o.object===n.object&&o.index===n.index&&o.instanceId===n.instanceId)){const l=n.eventObject.__r3f,p=l==null?void 0:l.handlers;if(b.hovered.delete(ye(n)),l!=null&&l.eventCount){const v={...n,intersections:a};p.onPointerOut==null||p.onPointerOut(v),p.onPointerLeave==null||p.onPointerLeave(v)}}}function g(a,b){for(let n=0;n<b.length;n++){const o=b[n].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(a)}}function h(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>u([]);case"onLostPointerCapture":return b=>{const{internal:n}=e.getState();"pointerId"in b&&n.capturedMap.has(b.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(b.pointerId)&&(n.capturedMap.delete(b.pointerId),u([]))})}}return function(n){const{onPointerMissed:o,internal:l}=e.getState();l.lastEvent.current=n;const p=a==="onPointerMove",v=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",m=i(n,p?r:void 0),c=v?t(n):0;a==="onPointerDown"&&(l.initialClick=[n.offsetX,n.offsetY],l.initialHits=m.map(y=>y.eventObject)),v&&!m.length&&c<=2&&(g(n,l.interaction),o&&o(n)),p&&u(m);function d(y){const P=y.eventObject,_=P.__r3f,w=_==null?void 0:_.handlers;if(_!=null&&_.eventCount)if(p){if(w.onPointerOver||w.onPointerEnter||w.onPointerOut||w.onPointerLeave){const x=ye(y),C=l.hovered.get(x);C?C.stopped&&y.stopPropagation():(l.hovered.set(x,y),w.onPointerOver==null||w.onPointerOver(y),w.onPointerEnter==null||w.onPointerEnter(y))}w.onPointerMove==null||w.onPointerMove(y)}else{const x=w[a];x?(!v||l.initialHits.includes(P))&&(g(n,l.interaction.filter(C=>!l.initialHits.includes(C))),x(y)):v&&l.initialHits.includes(P)&&g(n,l.interaction.filter(C=>!l.initialHits.includes(C)))}}s(m,n,c,d)}}return{handlePointer:h}}const bt=e=>!!(e!=null&&e.render),wt=f.createContext(null),An=(e,t)=>{const r=ut((h,a)=>{const b=new X,n=new X,o=new X;function l(c=a().camera,d=n,y=a().size){const{width:P,height:_,top:w,left:x}=y,C=P/_;d instanceof X?o.copy(d):o.set(...d);const S=c.getWorldPosition(b).distanceTo(o);if(dt(c))return{width:P/c.zoom,height:_/c.zoom,top:w,left:x,factor:1,distance:S,aspect:C};{const R=c.fov*Math.PI/180,E=2*Math.tan(R/2)*S,O=E*(P/_);return{width:O,height:E,top:w,left:x,factor:P/O,distance:S,aspect:C}}}let p;const v=c=>h(d=>({performance:{...d.performance,current:c}})),M=new Gt;return{set:h,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(c=1)=>e(a(),c),advance:(c,d)=>t(c,d,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Zt,pointer:M,mouse:M,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const c=a();p&&clearTimeout(p),c.performance.current!==c.performance.min&&v(c.performance.min),p=setTimeout(()=>v(a().performance.max),c.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:c=>h(d=>({...d,events:{...d.events,...c}})),setSize:(c,d,y,P,_)=>{const w=a().camera,x={width:c,height:d,top:P||0,left:_||0,updateStyle:y};h(C=>({size:x,viewport:{...C.viewport,...l(w,n,x)}}))},setDpr:c=>h(d=>{const y=ht(c);return{viewport:{...d.viewport,dpr:y,initialDpr:d.viewport.initialDpr||y}}}),setFrameloop:(c="always")=>{const d=a().clock;d.stop(),d.elapsedTime=0,c!=="never"&&(d.start(),d.elapsedTime=0),h(()=>({frameloop:c}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:f.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(c,d,y)=>{const P=a().internal;return P.priority=P.priority+(d>0?1:0),P.subscribers.push({ref:c,priority:d,store:y}),P.subscribers=P.subscribers.sort((_,w)=>_.priority-w.priority),()=>{const _=a().internal;_!=null&&_.subscribers&&(_.priority=_.priority-(d>0?1:0),_.subscribers=_.subscribers.filter(w=>w.ref!==c))}}}}}),i=r.getState();let s=i.size,u=i.viewport.dpr,g=i.camera;return r.subscribe(()=>{const{camera:h,size:a,viewport:b,gl:n,set:o}=r.getState();if(a.width!==s.width||a.height!==s.height||b.dpr!==u){var l;s=a,u=b.dpr,Rn(h,a),n.setPixelRatio(b.dpr);const p=(l=a.updateStyle)!=null?l:typeof HTMLCanvasElement<"u"&&n.domElement instanceof HTMLCanvasElement;n.setSize(a.width,a.height,p)}h!==g&&(g=h,o(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(h)}})))}),r.subscribe(h=>e(h)),r};let be,Dn=new Set,Ln=new Set,kn=new Set;function Te(e,t){if(e.size)for(const{callback:r}of e.values())r(t)}function le(e,t){switch(e){case"before":return Te(Dn,t);case"after":return Te(Ln,t);case"tail":return Te(kn,t)}}let je,Ae;function De(e,t,r){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),je=t.internal.subscribers,be=0;be<je.length;be++)Ae=je[be],Ae.ref.current(Ae.store.getState(),i,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Fn(e){let t=!1,r,i,s;function u(a){i=requestAnimationFrame(u),t=!0,r=0,le("before",a);for(const n of e.values()){var b;s=n.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((b=s.gl.xr)!=null&&b.isPresenting)&&(r+=De(a,s))}if(le("after",a),r===0)return le("tail",a),t=!1,cancelAnimationFrame(i)}function g(a,b=1){var n;if(!a)return e.forEach(o=>g(o.store.getState()),b);(n=a.gl.xr)!=null&&n.isPresenting||!a.internal.active||a.frameloop==="never"||(a.internal.frames=Math.min(60,a.internal.frames+b),t||(t=!0,requestAnimationFrame(u)))}function h(a,b=!0,n,o){if(b&&le("before",a),n)De(a,n,o);else for(const l of e.values())De(a,l.store.getState());b&&le("after",a)}return{loop:u,invalidate:g,advance:h}}function Et(){const e=f.useContext(wt);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function W(e=r=>r,t){return Et()(e,t)}function de(e,t=0){const r=Et(),i=r.getState().internal.subscribe,s=pt(e);return fe(()=>i(s,t,r),[t,i,r]),null}const st=new WeakMap;function Mt(e,t){return function(r,...i){let s=st.get(r);return s||(s=new r,st.set(r,s)),e&&e(s),Promise.all(i.map(u=>new Promise((g,h)=>s.load(u,a=>{a.scene&&Object.assign(a,Sn(a.scene)),g(a)},t,a=>h(new Error(`Could not load ${u}: ${a==null?void 0:a.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function Y(e,t,r,i){const s=Array.isArray(t)?t:[t],u=gn(Mt(r,i),[e,...s],{equal:A.equ});return Array.isArray(t)?u:u[0]}Y.preload=function(e,t,r){const i=Array.isArray(t)?t:[t];return yn(Mt(r),[e,...i])};Y.clear=function(e,t){const r=Array.isArray(t)?t:[t];return bn([e,...r])};const se=new Map,{invalidate:at,advance:ct}=Fn(se),{reconciler:Ee,applyProps:te}=En(se,On),ne={objects:"shallow",strict:!1},zn=(e,t)=>{const r=typeof e=="function"?e(t):e;return bt(r)?r:new Nt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Bn(e,t){const r=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:s,top:u,left:g,updateStyle:h=r}=t;return{width:i,height:s,top:u,left:g,updateStyle:h}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:s,top:u,left:g}=e.parentElement.getBoundingClientRect();return{width:i,height:s,top:u,left:g,updateStyle:r}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:r};return{width:0,height:0,top:0,left:0}}function In(e){const t=se.get(e),r=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,u=i||An(at,ct),g=r||Ee.createContainer(u,ie.ConcurrentRoot,null,!1,null,"",s,null);t||se.set(e,{fiber:g,store:u});let h,a=!1,b;return{configure(n={}){let{gl:o,size:l,scene:p,events:v,onCreated:M,shadows:m=!1,linear:c=!1,flat:d=!1,legacy:y=!1,orthographic:P=!1,frameloop:_="always",dpr:w=[1,2],performance:x,raycaster:C,camera:S,onPointerMissed:R}=n,E=u.getState(),O=E.gl;E.gl||E.set({gl:O=zn(o,e)});let H=E.raycaster;H||E.set({raycaster:H=new Bt});const{params:I,...k}=C||{};if(A.equ(k,H,ne)||te(H,{...k}),A.equ(I,H.params,ne)||te(H,{params:{...H.params,...I}}),!E.camera||E.camera===b&&!A.equ(b,S,ne)){b=S;const L=S instanceof Vt,T=L?S:P?new He(0,0,0,0,.1,1e3):new We(75,0,.1,1e3);L||(T.position.z=5,S&&te(T,S),!E.camera&&!(S!=null&&S.rotation)&&T.lookAt(0,0,0)),E.set({camera:T}),H.camera=T}if(!E.scene){let L;p instanceof Ye?L=p:(L=new Ye,p&&te(L,p)),E.set({scene:re(L)})}if(!E.xr){var N;const L=(F,me)=>{const ve=u.getState();ve.frameloop!=="never"&&ct(F,!0,ve,me)},T=()=>{const F=u.getState();F.gl.xr.enabled=F.gl.xr.isPresenting,F.gl.xr.setAnimationLoop(F.gl.xr.isPresenting?L:null),F.gl.xr.isPresenting||at(F)},q={connect(){const F=u.getState().gl;F.xr.addEventListener("sessionstart",T),F.xr.addEventListener("sessionend",T)},disconnect(){const F=u.getState().gl;F.xr.removeEventListener("sessionstart",T),F.xr.removeEventListener("sessionend",T)}};typeof((N=O.xr)==null?void 0:N.addEventListener)=="function"&&q.connect(),E.set({xr:q})}if(O.shadowMap){const L=O.shadowMap.enabled,T=O.shadowMap.type;if(O.shadowMap.enabled=!!m,A.boo(m))O.shadowMap.type=Pe;else if(A.str(m)){var z;const q={basic:qt,percentage:Ut,soft:Pe,variance:Xt};O.shadowMap.type=(z=q[m])!=null?z:Pe}else A.obj(m)&&Object.assign(O.shadowMap,m);(L!==O.shadowMap.enabled||T!==O.shadowMap.type)&&(O.shadowMap.needsUpdate=!0)}const B=ft();B&&("enabled"in B?B.enabled=!y:"legacyMode"in B&&(B.legacyMode=y)),te(O,{outputEncoding:c?3e3:3001,toneMapping:d?It:Ht}),E.legacy!==y&&E.set(()=>({legacy:y})),E.linear!==c&&E.set(()=>({linear:c})),E.flat!==d&&E.set(()=>({flat:d})),o&&!A.fun(o)&&!bt(o)&&!A.equ(o,O,ne)&&te(O,o),v&&!E.events.handlers&&E.set({events:v(u)});const D=Bn(e,l);return A.equ(D,E.size,ne)||E.setSize(D.width,D.height,D.updateStyle,D.top,D.left),w&&E.viewport.dpr!==ht(w)&&E.setDpr(w),E.frameloop!==_&&E.setFrameloop(_),E.onPointerMissed||E.set({onPointerMissed:R}),x&&!A.equ(x,E.performance,ne)&&E.set(L=>({performance:{...L.performance,...x}})),h=M,a=!0,this},render(n){return a||this.configure(),Ee.updateContainer(f.createElement(Hn,{store:u,children:n,onCreated:h,rootElement:e}),g,null,()=>{}),u},unmount(){_t(e)}}}function Hn({store:e,children:t,onCreated:r,rootElement:i}){return fe(()=>{const s=e.getState();s.set(u=>({internal:{...u.internal,active:!0}})),r&&r(s),e.getState().events.connected||s.events.connect==null||s.events.connect(i)},[]),f.createElement(wt.Provider,{value:e},t)}function _t(e,t){const r=se.get(e),i=r==null?void 0:r.fiber;if(i){const s=r==null?void 0:r.store.getState();s&&(s.internal.active=!1),Ee.updateContainer(null,i,null,()=>{s&&setTimeout(()=>{try{var u,g,h,a;s.events.disconnect==null||s.events.disconnect(),(u=s.gl)==null||(g=u.renderLists)==null||g.dispose==null||g.dispose(),(h=s.gl)==null||h.forceContextLoss==null||h.forceContextLoss(),(a=s.gl)!=null&&a.xr&&s.xr.disconnect(),xn(s),se.delete(e),t&&t(e)}catch{}},500)})}}Ee.injectIntoDevTools({bundleType:1,rendererPackageName:"@react-three/fiber",version:f.version});const Le={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Wn(e){const{handlePointer:t}=jn(e);return{priority:1,enabled:!0,compute(r,i,s){i.pointer.set(r.offsetX/i.size.width*2-1,-(r.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(Le).reduce((r,i)=>({...r,[i]:t(i)}),{}),update:()=>{var r;const{events:i,internal:s}=e.getState();(r=s.lastEvent)!=null&&r.current&&i.handlers&&i.handlers.onPointerMove(s.lastEvent.current)},connect:r=>{var i;const{set:s,events:u}=e.getState();u.disconnect==null||u.disconnect(),s(g=>({events:{...g.events,connected:r}})),Object.entries((i=u.handlers)!=null?i:[]).forEach(([g,h])=>{const[a,b]=Le[g];r.addEventListener(a,h,{passive:b})})},disconnect:()=>{const{set:r,events:i}=e.getState();if(i.connected){var s;Object.entries((s=i.handlers)!=null?s:[]).forEach(([u,g])=>{if(i&&i.connected instanceof HTMLElement){const[h]=Le[u];i.connected.removeEventListener(h,g)}}),r(u=>({events:{...u.events,connected:void 0}}))}}}}const $n=f.forwardRef(function({children:t,fallback:r,resize:i,style:s,gl:u,events:g=Wn,eventSource:h,eventPrefix:a,shadows:b,linear:n,flat:o,legacy:l,orthographic:p,frameloop:v,dpr:M,performance:m,raycaster:c,camera:d,scene:y,onPointerMissed:P,onCreated:_,...w},x){f.useMemo(()=>wn(Yt),[]);const C=ln(),[S,R]=an({scroll:!0,debounce:{scroll:50,resize:0},...i}),E=f.useRef(null),O=f.useRef(null);f.useImperativeHandle(x,()=>E.current);const H=pt(P),[I,k]=f.useState(!1),[N,z]=f.useState(!1);if(I)throw I;if(N)throw N;const B=f.useRef(null);fe(()=>{const $=E.current;R.width>0&&R.height>0&&$&&(B.current||(B.current=In($)),B.current.configure({gl:u,events:g,shadows:b,linear:n,flat:o,legacy:l,orthographic:p,frameloop:v,dpr:M,performance:m,raycaster:c,camera:d,scene:y,size:R,onPointerMissed:(...D)=>H.current==null?void 0:H.current(...D),onCreated:D=>{D.events.connect==null||D.events.connect(h?Mn(h)?h.current:h:O.current),a&&D.setEvents({compute:(L,T)=>{const q=L[a+"X"],F=L[a+"Y"];T.pointer.set(q/T.size.width*2-1,-(F/T.size.height)*2+1),T.raycaster.setFromCamera(T.pointer,T.camera)}}),_==null||_(D)}}),B.current.render(f.createElement(C,null,f.createElement(mt,{set:z},f.createElement(f.Suspense,{fallback:f.createElement(_n,{set:k})},t)))))}),f.useEffect(()=>{const $=E.current;if($)return()=>_t($)},[]);const U=h?"none":"auto";return f.createElement("div",V({ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:U,...s}},w),f.createElement("div",{ref:S,style:{width:"100%",height:"100%"}},f.createElement("canvas",{ref:E,style:{display:"block"}},r)))}),dr=f.forwardRef(function(t,r){return f.createElement(cn,null,f.createElement($n,V({},t,{ref:r})))}),pe=new X,Ve=new X,Gn=new X;function Nn(e,t,r){const i=pe.setFromMatrixPosition(e.matrixWorld);i.project(t);const s=r.width/2,u=r.height/2;return[i.x*s+s,-(i.y*u)+u]}function Vn(e,t){const r=pe.setFromMatrixPosition(e.matrixWorld),i=Ve.setFromMatrixPosition(t.matrixWorld),s=r.sub(i),u=t.getWorldDirection(Gn);return s.angleTo(u)>Math.PI/2}function qn(e,t,r,i){const s=pe.setFromMatrixPosition(e.matrixWorld),u=s.clone();u.project(t),r.setFromCamera(u,t);const g=r.intersectObjects(i,!0);if(g.length){const h=g[0].distance;return s.distanceTo(r.ray.origin)<h}return!0}function Un(e,t){if(t instanceof He)return t.zoom;if(t instanceof We){const r=pe.setFromMatrixPosition(e.matrixWorld),i=Ve.setFromMatrixPosition(t.matrixWorld),s=t.fov*Math.PI/180,u=r.distanceTo(i);return 1/(2*Math.tan(s/2)*u)}else return 1}function Xn(e,t,r){if(t instanceof We||t instanceof He){const i=pe.setFromMatrixPosition(e.matrixWorld),s=Ve.setFromMatrixPosition(t.matrixWorld),u=i.distanceTo(s),g=(r[1]-r[0])/(t.far-t.near),h=r[1]-g*t.far;return Math.round(g*u+h)}}const Ie=e=>Math.abs(e)<1e-10?0:e;function Pt(e,t,r=""){let i="matrix3d(";for(let s=0;s!==16;s++)i+=Ie(t[s]*e.elements[s])+(s!==15?",":")");return r+i}const Zn=(e=>t=>Pt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Yn=(e=>(t,r)=>Pt(t,e(r),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function Kn(e){return e&&typeof e=="object"&&"current"in e}const pr=f.forwardRef(({children:e,eps:t=.001,style:r,className:i,prepend:s,center:u,fullscreen:g,portal:h,distanceFactor:a,sprite:b=!1,transform:n=!1,occlude:o,onOcclude:l,castShadow:p,receiveShadow:v,material:M,geometry:m,zIndexRange:c=[16777271,0],calculatePosition:d=Nn,as:y="div",wrapperClass:P,pointerEvents:_="auto",...w},x)=>{const{gl:C,camera:S,scene:R,size:E,raycaster:O,events:H,viewport:I}=W(),[k]=f.useState(()=>document.createElement(y)),N=f.useRef(),z=f.useRef(null),B=f.useRef(0),U=f.useRef([0,0]),$=f.useRef(null),D=f.useRef(null),L=(h==null?void 0:h.current)||H.connected||C.domElement.parentNode,T=f.useRef(null),q=f.useRef(!1),F=f.useMemo(()=>o&&o!=="blending"||Array.isArray(o)&&o.length&&Kn(o[0]),[o]);f.useLayoutEffect(()=>{const G=C.domElement;o&&o==="blending"?(G.style.zIndex=`${Math.floor(c[0]/2)}`,G.style.position="absolute",G.style.pointerEvents="none"):(G.style.zIndex=null,G.style.position=null,G.style.pointerEvents=null)},[o]),f.useLayoutEffect(()=>{if(z.current){const G=N.current=fn(k);if(R.updateMatrixWorld(),n)k.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const j=d(z.current,S,E);k.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${j[0]}px,${j[1]}px,0);transform-origin:0 0;`}return L&&(s?L.prepend(k):L.appendChild(k)),()=>{L&&L.removeChild(k),G.unmount()}}},[L,n]),f.useLayoutEffect(()=>{P&&(k.className=P)},[P]);const me=f.useMemo(()=>n?{position:"absolute",top:0,left:0,width:E.width,height:E.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:u?"translate3d(-50%,-50%,0)":"none",...g&&{top:-E.height/2,left:-E.width/2,width:E.width,height:E.height},...r},[r,u,g,E,n]),ve=f.useMemo(()=>({position:"absolute",pointerEvents:_}),[_]);f.useLayoutEffect(()=>{if(q.current=!1,n){var G;(G=N.current)==null||G.render(f.createElement("div",{ref:$,style:me},f.createElement("div",{ref:D,style:ve},f.createElement("div",{ref:x,className:i,style:r,children:e}))))}else{var j;(j=N.current)==null||j.render(f.createElement("div",{ref:x,style:me,className:i,children:e}))}});const ee=f.useRef(!0);de(G=>{if(z.current){S.updateMatrixWorld(),z.current.updateWorldMatrix(!0,!1);const j=n?U.current:d(z.current,S,E);if(n||Math.abs(B.current-S.zoom)>t||Math.abs(U.current[0]-j[0])>t||Math.abs(U.current[1]-j[1])>t){const K=Vn(z.current,S);let Z=!1;F&&(Array.isArray(o)?Z=o.map(J=>J.current):o!=="blending"&&(Z=[R]));const ae=ee.current;if(Z){const J=qn(z.current,S,O,Z);ee.current=J&&!K}else ee.current=!K;ae!==ee.current&&(l?l(!ee.current):k.style.display=ee.current?"block":"none");const he=Math.floor(c[0]/2),Rt=o?F?[c[0],he]:[he-1,0]:c;if(k.style.zIndex=`${Xn(z.current,S,Rt)}`,n){const[J,Xe]=[E.width/2,E.height/2],Me=S.projectionMatrix.elements[5]*Xe,{isOrthographicCamera:Ze,top:Ot,left:Tt,bottom:jt,right:At}=S,Dt=Zn(S.matrixWorldInverse),Lt=Ze?`scale(${Me})translate(${Ie(-(At+Tt)/2)}px,${Ie((Ot+jt)/2)}px)`:`translateZ(${Me}px)`;let Q=z.current.matrixWorld;b&&(Q=S.matrixWorldInverse.clone().transpose().copyPosition(Q).scale(z.current.scale),Q.elements[3]=Q.elements[7]=Q.elements[11]=0,Q.elements[15]=1),k.style.width=E.width+"px",k.style.height=E.height+"px",k.style.perspective=Ze?"":`${Me}px`,$.current&&D.current&&($.current.style.transform=`${Lt}${Dt}translate(${J}px,${Xe}px)`,D.current.style.transform=Yn(Q,1/((a||10)/400)))}else{const J=a===void 0?1:Un(z.current,S)*a;k.style.transform=`translate3d(${j[0]}px,${j[1]}px,0) scale(${J})`}U.current=j,B.current=S.zoom}}if(!F&&T.current&&!q.current)if(n){if($.current){const j=$.current.children[0];if(j!=null&&j.clientWidth&&j!=null&&j.clientHeight){const{isOrthographicCamera:K}=S;if(K||m)w.scale&&(Array.isArray(w.scale)?w.scale instanceof X?T.current.scale.copy(w.scale.clone().divideScalar(1)):T.current.scale.set(1/w.scale[0],1/w.scale[1],1/w.scale[2]):T.current.scale.setScalar(1/w.scale));else{const Z=(a||10)/400,ae=j.clientWidth*Z,he=j.clientHeight*Z;T.current.scale.set(ae,he,1)}q.current=!0}}}else{const j=k.children[0];if(j!=null&&j.clientWidth&&j!=null&&j.clientHeight){const K=1/I.factor,Z=j.clientWidth*K,ae=j.clientHeight*K;T.current.scale.set(Z,ae,1),q.current=!0}T.current.lookAt(G.camera.position)}});const Ue=f.useMemo(()=>({vertexShader:n?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[n]);return f.createElement("group",V({},w,{ref:z}),o&&!F&&f.createElement("mesh",{castShadow:p,receiveShadow:v,ref:T},m||f.createElement("planeGeometry",null),M||f.createElement("shaderMaterial",{side:ke,vertexShader:Ue.vertexShader,fragmentShader:Ue.fragmentShader})))});let ue=0;const mr=ut(e=>(ge.onStart=(t,r,i)=>{e({active:!0,item:t,loaded:r,total:i,progress:(r-ue)/(i-ue)*100})},ge.onLoad=()=>{e({active:!1})},ge.onError=t=>e(r=>({errors:[...r.errors,t]})),ge.onProgress=(t,r,i)=>{r===i&&(ue=i),e({active:!0,item:t,loaded:r,total:i,progress:(r-ue)/(i-ue)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),vr=f.forwardRef(function({src:t,skipFill:r,skipStrokes:i,fillMaterial:s,strokeMaterial:u,fillMeshProps:g,strokeMeshProps:h,...a},b){const n=Y(Se,t.startsWith("<svg")?`data:image/svg+xml;utf8,${t}`:t),o=f.useMemo(()=>i?[]:n.paths.map(l=>{var p;return((p=l.userData)==null?void 0:p.style.stroke)===void 0||l.userData.style.stroke==="none"?null:l.subPaths.map(v=>Se.pointsToStroke(v.getPoints(),l.userData.style))}),[n,i]);return f.useEffect(()=>()=>o.forEach(l=>l&&l.map(p=>p.dispose())),[o]),f.createElement("object3D",V({ref:b},a),f.createElement("object3D",{scale:[1,-1,1]},n.paths.map((l,p)=>{var v,M;return f.createElement(f.Fragment,{key:p},!r&&((v=l.userData)==null?void 0:v.style.fill)!==void 0&&l.userData.style.fill!=="none"&&Se.createShapes(l).map((m,c)=>f.createElement("mesh",V({key:c},g),f.createElement("shapeGeometry",{args:[m]}),f.createElement("meshBasicMaterial",V({color:l.userData.style.fill,opacity:l.userData.style.fillOpacity,transparent:!0,side:ke,depthWrite:!1},s)))),!i&&((M=l.userData)==null?void 0:M.style.stroke)!==void 0&&l.userData.style.stroke!=="none"&&l.subPaths.map((m,c)=>f.createElement("mesh",V({key:c,geometry:o[p][c]},h),f.createElement("meshBasicMaterial",V({color:l.userData.style.stroke,opacity:l.userData.style.strokeOpacity,transparent:!0,side:ke,depthWrite:!1},u)))))})))});let we=null,St="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function xt(e,t,r){return i=>{r&&r(i),e&&(we||(we=new dn),we.setDecoderPath(typeof e=="string"?e:St),i.setDRACOLoader(we)),t&&i.setMeshoptDecoder(typeof xe=="function"?xe():xe)}}function qe(e,t=!0,r=!0,i){return Y($e,e,xt(t,r,i))}qe.preload=(e,t=!0,r=!0,i)=>Y.preload($e,e,xt(t,r,i));qe.clear=e=>Y.clear($e,e);qe.setDecoderPath=e=>{St=e};function Jn(e,t,r){const i=W(l=>l.size),s=W(l=>l.viewport),u=typeof e=="number"?e:i.width*s.dpr,g=typeof t=="number"?t:i.height*s.dpr,h=(typeof e=="number"?r:e)||{},{samples:a=0,depth:b,...n}=h,o=f.useMemo(()=>{const l=new Fe(u,g,{minFilter:Ke,magFilter:Ke,type:Kt,...n});return b&&(l.depthTexture=new Jt(u,g,Qt)),l.samples=a,l},[]);return f.useLayoutEffect(()=>{o.setSize(u,g),a&&(o.samples=a)},[a,o,u,g]),f.useEffect(()=>()=>o.dispose(),[]),o}const Qn=e=>typeof e=="function",hr=f.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:i,children:s,...u},g)=>{const h=W(({set:m})=>m),a=W(({camera:m})=>m),b=W(({size:m})=>m),n=f.useRef(null),o=f.useRef(null),l=Jn(t);f.useLayoutEffect(()=>{u.manual||(n.current.aspect=b.width/b.height)},[b,u]),f.useLayoutEffect(()=>{n.current.updateProjectionMatrix()});let p=0,v=null;const M=Qn(s);return de(m=>{M&&(r===1/0||p<r)&&(o.current.visible=!1,m.gl.setRenderTarget(l),v=m.scene.background,e&&(m.scene.background=e),m.gl.render(m.scene,n.current),m.scene.background=v,m.gl.setRenderTarget(null),o.current.visible=!0,p++)}),f.useLayoutEffect(()=>{if(i){const m=a;return h(()=>({camera:n.current})),()=>h(()=>({camera:m}))}},[n,i,h]),f.createElement(f.Fragment,null,f.createElement("perspectiveCamera",V({ref:hn([n,g])},u),!M&&s),f.createElement("group",{ref:o},M&&s(l.texture)))}),gr=f.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:i,enableDamping:s=!0,keyEvents:u=!1,onChange:g,onStart:h,onEnd:a,...b},n)=>{const o=W(w=>w.invalidate),l=W(w=>w.camera),p=W(w=>w.gl),v=W(w=>w.events),M=W(w=>w.setEvents),m=W(w=>w.set),c=W(w=>w.get),d=W(w=>w.performance),y=t||l,P=i||v.connected||p.domElement,_=f.useMemo(()=>new pn(y),[y]);return de(()=>{_.enabled&&_.update()},-1),f.useEffect(()=>(u&&_.connect(u===!0?P:u),_.connect(P),()=>void _.dispose()),[u,P,r,_,o]),f.useEffect(()=>{const w=S=>{o(),r&&d.regress(),g&&g(S)},x=S=>{h&&h(S)},C=S=>{a&&a(S)};return _.addEventListener("change",w),_.addEventListener("start",x),_.addEventListener("end",C),()=>{_.removeEventListener("start",x),_.removeEventListener("end",C),_.removeEventListener("change",w)}},[g,h,a,_,o,M]),f.useEffect(()=>{if(e){const w=c().controls;return m({controls:_}),()=>m({controls:w})}},[e,_]),f.createElement("primitive",V({ref:n,object:_,enableDamping:s},b))});function Ct(e){return Y(Ge,e)}Ct.preload=e=>Y.preload(Ge,e);Ct.clear=e=>Y.clear(Ge,e);function yr(e,t){const r=f.useRef(),[i]=f.useState(()=>t?t instanceof Je?{current:t}:t:r),[s]=f.useState(()=>new en(void 0));f.useLayoutEffect(()=>{t&&(i.current=t instanceof Je?t:t.current),s._root=i.current});const u=f.useRef({}),g=f.useMemo(()=>{const h={};return e.forEach(a=>Object.defineProperty(h,a.name,{enumerable:!0,get(){if(i.current)return u.current[a.name]||(u.current[a.name]=s.clipAction(a,i.current))},configurable:!0})),{ref:i,clips:e,actions:h,names:e.map(a=>a.name),mixer:s}},[e]);return de((h,a)=>s.update(a)),f.useEffect(()=>{const h=i.current;return()=>{u.current={},s.stopAllAction(),Object.values(g.actions).forEach(a=>{h&&s.uncacheAction(a,h)})}},[e]),g}const br=f.forwardRef(function({children:t,disable:r,disableX:i,disableY:s,disableZ:u,left:g,right:h,top:a,bottom:b,front:n,back:o,onCentered:l,precise:p=!0,cacheKey:v=0,...M},m){const c=f.useRef(null),d=f.useRef(null),y=f.useRef(null);return f.useLayoutEffect(()=>{d.current.matrixWorld.identity();const P=new tn().setFromObject(y.current,p),_=new X,w=new nn,x=P.max.x-P.min.x,C=P.max.y-P.min.y,S=P.max.z-P.min.z;P.getCenter(_),P.getBoundingSphere(w);const R=a?C/2:b?-C/2:0,E=g?-x/2:h?x/2:0,O=n?S/2:o?-S/2:0;d.current.position.set(r||i?0:-_.x+E,r||s?0:-_.y+R,r||u?0:-_.z+O),typeof l<"u"&&l({parent:c.current.parent,container:c.current,width:x,height:C,depth:S,boundingBox:P,boundingSphere:w,center:_,verticalAlignment:R,horizontalAlignment:E,depthAlignment:O})},[v,l,a,g,n,r,i,s,u,p,h,b,o]),f.useImperativeHandle(m,()=>c.current,[]),f.createElement("group",V({ref:c},M),f.createElement("group",{ref:d},f.createElement("group",{ref:y},t)))}),wr=f.forwardRef(({scale:e=10,frames:t=1/0,opacity:r=1,width:i=1,height:s=1,blur:u=1,near:g=0,far:h=10,resolution:a=512,smooth:b=!0,color:n="#000000",depthWrite:o=!1,renderOrder:l,...p},v)=>{const M=f.useRef(null),m=W(I=>I.scene),c=W(I=>I.gl),d=f.useRef(null);i=i*(Array.isArray(e)?e[0]:e||1),s=s*(Array.isArray(e)?e[1]:e||1);const[y,P,_,w,x,C,S]=f.useMemo(()=>{const I=new Fe(a,a),k=new Fe(a,a);k.texture.generateMipmaps=I.texture.generateMipmaps=!1;const N=new rn(i,s).rotateX(Math.PI/2),z=new on(N),B=new sn;B.depthTest=B.depthWrite=!1,B.onBeforeCompile=D=>{D.uniforms={...D.uniforms,ucolor:{value:new lt(n)}},D.fragmentShader=D.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),D.fragmentShader=D.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const U=new Qe(mn),$=new Qe(vn);return $.depthTest=U.depthTest=!1,[I,N,B,z,U,$,k]},[a,i,s,e,n]),R=I=>{w.visible=!0,w.material=x,x.uniforms.tDiffuse.value=y.texture,x.uniforms.h.value=I*1/256,c.setRenderTarget(S),c.render(w,d.current),w.material=C,C.uniforms.tDiffuse.value=S.texture,C.uniforms.v.value=I*1/256,c.setRenderTarget(y),c.render(w,d.current),w.visible=!1};let E=0,O,H;return de(()=>{d.current&&(t===1/0||E<t)&&(E++,O=m.background,H=m.overrideMaterial,M.current.visible=!1,m.background=null,m.overrideMaterial=_,c.setRenderTarget(y),c.render(m,d.current),R(u),b&&R(u*.4),c.setRenderTarget(null),M.current.visible=!0,m.overrideMaterial=H,m.background=O)}),f.useImperativeHandle(v,()=>M.current,[]),f.createElement("group",V({"rotation-x":Math.PI/2},p,{ref:M}),f.createElement("mesh",{renderOrder:l,geometry:P,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},f.createElement("meshBasicMaterial",{transparent:!0,map:y.texture,opacity:r,depthWrite:o})),f.createElement("orthographicCamera",{ref:d,args:[-i/2,i/2,s/2,-s/2,g,h]}))});export{br as C,pr as H,gr as O,hr as P,vr as S,qe as a,Ct as b,yr as c,wr as d,dr as e,mr as f,de as u};
//# sourceMappingURL=vendor-@react-three.js.map
